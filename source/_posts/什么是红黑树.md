---
title: 什么是红黑树
date: 2020-07-27 22:08:04
tags: 
- 树
- 红黑树
- 数据结构
categories: 数据结构与算法
---

## 1.红黑树定义

红黑树的定义也是它的性质，有以下五条：

- 性质1. 所有节点是红色或黑色
- 性质2. 根节点是黑色
- 性质3. 所有叶子都是黑色（叶子是NIL节点）
- 性质4. 如果一个节点是红的，则它的两个儿子都是黑的
- 性质5. 从任一节点到其叶子的所有简单路径都包含相同数目的黑色节点。

下图是一棵红黑树

<p><img src="/assets/blogImg/什么是红黑树_01.png" width="500"></p>

## 2. 红黑树的基本操作

### 2.1.查找操作

因为红黑树也是二叉查找树，因此红黑树上的查找操作与普通二叉查找树上的查找操作相同。

### 2.2.插入操作

#### 2.2.1.为什么插入的节点总是红色

因为插入一个红色节点比插入一个黑色节点破坏红黑特性的可能性更小，具体原因如下：

1. 插入黑色节点总会改变黑色高度（违背性质5），但是插入红色节点只有一半的机会会违背性质4。
2. 违背性质4比违背性质5要更容易修正。

#### 2.2.2.插入节点破坏红黑树平衡的3种情况

1. 如果是第一次插入，原树为空，只会违反红黑树的规则2，所以只要把插入的根节点改成黑色即可；

2. 如果插入节点的父节点是黑色的，那不会违背红黑树的规则，什么也不需要做；

3. 如果插入节点的父节点是红色的，又分为以下3种情况：

   3.1. 插入节点的父节点和其叔叔节点均为红色的；

   3.2. 插入节点的父节点是红色，叔叔节点是黑色，且插入节点是其父节点的左节点；

   3.3. 插入节点的父节点是红色，叔叔节点是黑色，且插入节点是其父节点的右节点。

下面具体分析情况3的各个情况需要什么操作才可以保持红黑树的平衡：

##### 插入节点的父节点和其叔叔节点均为红色的

这个情况比较简单，只需要变色就行了，如下图左边的红黑树，将当前节点4的父节点5和叔叔节点8涂黑，将祖父节点7涂红，变成上图右边的红黑树。**再将当前节点指向节点7，再次从新的当前节点7开始算法**

<p><img src="/assets/blogImg/什么是红黑树_2.png" width="900"></p>

##### 插入节点的父节点是红色，叔叔节点是黑色，且插入节点是其父节点的右节点

将当前节点7的父节点2作为支点做左旋操作。完成后如下图左边的红黑树所示。**再将当前节点指向节点2，再次从新的当前节点2开始算法**

<p><img src="/assets/blogImg/什么是红黑树_3.png" width="900"></p>

##### 插入节点的父节点是红色，叔叔节点是黑色，且插入节点是其父节点的左节点

将当前节点2的父节点7涂黑，将祖父节点11涂红，以祖父节点11为支点做右旋操作。最后把根节点涂黑，整个红黑树重新恢复了平衡，如上图右边的红黑树所示。至此，插入操作完成！

#### 2.2.3变色，左旋转，右旋转的先后顺序

我们可以看出，如果是从情况1开始发生的，必然会走完情况2和3，也就是说这是一整个流程。当然，实际情况可能不会从情况1发生，如果从情况2开始发生，那再走个情况3即可完成调整，如果直接只要调整情况3，那么前两种情况均不需要调整了。故变色和旋转之间的先后关系可以表示为：变色->左旋->右旋。

### 2.3.删除操作

下次复习总结的时候补上

## 3.红黑树的应用场景

红黑树的应用场景很多，比如

1. Java中的TreeMap以及JDK1.8以后的HashMap（当节点中链表长度大于8时会将链表转为红黑树）

## 4.引用

https://baijiahao.baidu.com/s?id=1645429373049393021&wfr=spider&for=pc

https://www.jianshu.com/p/30afcf59828f

https://blog.csdn.net/eson_15/article/details/51144079